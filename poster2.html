<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Land Art – Interaktivní plakát</title>
  <style>
    html, body{
      margin:0;
      height:100%;
      overflow:hidden;
      background:#0f1115;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }

    #app{
      position:fixed;
      inset:0;
      display:grid;
      place-items:center;
      padding:12px;
      box-sizing:border-box;
    }

    /* Poster always fully visible */
    #poster{
      position:relative;
      width:min(100vw - 24px, (100vh - 24px) * (3/4));
      height:min(100vh - 24px, (100vw - 24px) * (4/3));
      aspect-ratio:3/4;
      border-radius:18px;
      overflow:hidden;
      box-shadow:0 18px 60px rgba(0,0,0,.55);
      background:#222 url("poster.png") center/cover no-repeat;
      touch-action:none;
    }

    /* -------- Floating sticker PNGs -------- */
    @keyframes floaty{
      0%   { transform:translate(-50%,-50%) translateY(0px) rotate(var(--rot,0deg)); }
      50%  { transform:translate(-50%,-50%) translateY(var(--amp,-6px)) rotate(var(--rot,0deg)); }
      100% { transform:translate(-50%,-50%) translateY(0px) rotate(var(--rot,0deg)); }
    }

    .sticker{
      position:absolute;
      left:50%;
      top:50%;
      width:260px;
      transform:translate(-50%,-50%);
      user-select:none;
      -webkit-user-drag:none;
      pointer-events:none;
      filter:drop-shadow(0 18px 40px rgba(0,0,0,.35));
      will-change:transform;
      animation:floaty 5s ease-in-out infinite;
      z-index:30;
    }
    .sticker img{ display:block; width:100%; height:auto; pointer-events:none; }
    .sticker[data-float="1"]{ animation-duration:4.5s; animation-delay:-0.6s; --amp:-7px; }
    .sticker[data-float="2"]{ animation-duration:5.5s; animation-delay:-1.8s; --amp:-9px; }
    .sticker[data-float="3"]{ animation-duration:6.0s; animation-delay:-2.7s; --amp:-6px; }
    .sticker[data-float="4"]{ animation-duration:4.8s; animation-delay:-3.4s; --amp:-8px; }

    /* -------- Draggable objects -------- */
    .obj{
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%) rotate(0deg) scale(1);
      transform-origin:center;
      user-select:none;
      -webkit-user-drag:none;
      touch-action:none;
      cursor:grab;
      filter:drop-shadow(0 12px 18px rgba(0,0,0,.35));
    }
    .obj:active{ cursor:grabbing; }
    .obj img{ display:block; width:100%; height:auto; pointer-events:none; }

    /* selection outline */
    .selected{
      outline:2px dashed rgba(255,255,255,.75);
      outline-offset:10px;
      border-radius:18px;
    }

    /* rotate handle like Figma */
    .rotate-handle{
      position:absolute;
      top:-36px;
      left:50%;
      transform:translateX(-50%);
      width:22px;
      height:22px;
      border-radius:50%;
      background:#ffd21f;
      border:2px solid #111;
      box-shadow:0 4px 12px rgba(0,0,0,.35);
      cursor:grab;
      display:none;
    }
    .obj.selected .rotate-handle{ display:block; }
  </style>
</head>

<body>
  <div id="app">
    <div id="poster" aria-label="Interaktivní plakát"></div>
  </div>

<script>
  const poster = document.getElementById("poster");
  let selected = null;

  /* ---------- Stickers ---------- */
  function addStickerPNG({ src, x, y, w=260, rot=0, floatVariant=1 }) {
    const s = document.createElement("div");
    s.className = "sticker";
    s.dataset.float = String(floatVariant);
    s.style.left = `${x}%`;
    s.style.top  = `${y}%`;
    s.style.width = `${w}px`;
    s.style.setProperty("--rot", `${rot}deg`);

    const img = document.createElement("img");
    img.src = src;
    img.alt = "";
    s.appendChild(img);

    poster.appendChild(s);
  }

  /* ---------- Helpers ---------- */
  function select(node){
    if (selected) selected.classList.remove("selected");
    selected = node;
    if (selected) selected.classList.add("selected");
  }

  function applyTransform(node){
    const rot = parseFloat(node.dataset.rot || "0");
    const scale = parseFloat(node.dataset.scale || "1");
    node.style.transform = `translate(-50%,-50%) rotate(${rot}deg) scale(${scale})`;
  }

  function setZ(node, z){
    node.dataset.z = String(z);
    node.style.zIndex = String(z);
  }

  function bringForward(node){ setZ(node, parseInt(node.dataset.z || "20", 10) + 1); }
  function sendBackward(node){ setZ(node, parseInt(node.dataset.z || "20", 10) - 1); }

  function getAllZ(){
    return [...poster.querySelectorAll(".obj")].map(n => parseInt(n.dataset.z || "20", 10));
  }
  function bringToFront(node){
    const maxZ = Math.max(20, ...getAllZ());
    setZ(node, maxZ + 1);
  }
  function sendToBack(node){
    const minZ = Math.min(20, ...getAllZ());
    setZ(node, minZ - 1);
  }

  /* ---------- Object factory (drag + rotate handle) ---------- */
  function makeObject({ src, x, y, w, rot=0, scale=1, z=20 }) {
    const wrap = document.createElement("div");
    wrap.className = "obj";
    wrap.style.left = `${x}%`;
    wrap.style.top  = `${y}%`;
    wrap.style.width = `${w}px`;

    wrap.dataset.rot = String(rot);
    wrap.dataset.scale = String(scale);
    setZ(wrap, z);

    const img = document.createElement("img");
    img.src = src;
    img.alt = "";
    wrap.appendChild(img);

    // rotate handle
    const handle = document.createElement("div");
    handle.className = "rotate-handle";
    wrap.appendChild(handle);

    applyTransform(wrap);

    // select
    wrap.addEventListener("click", (e) => {
      e.stopPropagation();
      select(wrap);
    });

    // drag (ignore handle)
    wrap.addEventListener("pointerdown", (e) => {
      if (e.target === handle) return;
      e.preventDefault();
      e.stopPropagation();

      select(wrap);
      bringForward(wrap);

      const rect = poster.getBoundingClientRect();
      const startX = e.clientX - rect.left;
      const startY = e.clientY - rect.top;

      const curX = (parseFloat(wrap.style.left)/100) * rect.width;
      const curY = (parseFloat(wrap.style.top)/100)  * rect.height;

      const dx = startX - curX;
      const dy = startY - curY;

      wrap.setPointerCapture(e.pointerId);

      const move = (ev) => {
        const xPx = (ev.clientX - rect.left) - dx;
        const yPx = (ev.clientY - rect.top)  - dy;

        wrap.style.left = `${(xPx / rect.width) * 100}%`;
        wrap.style.top  = `${(yPx / rect.height) * 100}%`;
      };

      const up = () => {
        wrap.releasePointerCapture(e.pointerId);
        wrap.removeEventListener("pointermove", move);
        wrap.removeEventListener("pointerup", up);
        wrap.removeEventListener("pointercancel", up);
      };

      wrap.addEventListener("pointermove", move);
      wrap.addEventListener("pointerup", up);
      wrap.addEventListener("pointercancel", up);
    });

    // rotate by handle
    handle.addEventListener("pointerdown", (e) => {
      e.preventDefault();
      e.stopPropagation();
      select(wrap);
      bringForward(wrap);

      const rect = wrap.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top  + rect.height / 2;

      const startAngle = Math.atan2(e.clientY - cy, e.clientX - cx);
      const startRot = parseFloat(wrap.dataset.rot || "0");

      handle.setPointerCapture(e.pointerId);

      const move = (ev) => {
        const angle = Math.atan2(ev.clientY - cy, ev.clientX - cx);
        const delta = angle - startAngle;
        const deg = startRot + delta * (180 / Math.PI);
        wrap.dataset.rot = String(deg);
        applyTransform(wrap);
      };

      const up = () => {
        handle.releasePointerCapture(e.pointerId);
        handle.removeEventListener("pointermove", move);
        handle.removeEventListener("pointerup", up);
        handle.removeEventListener("pointercancel", up);
      };

      handle.addEventListener("pointermove", move);
      handle.addEventListener("pointerup", up);
      handle.addEventListener("pointercancel", up);
    });

    poster.appendChild(wrap);
    return wrap;
  }

  /* ---------- No UI interactions ---------- */
  poster.addEventListener("click", () => select(null));

  // wheel scale
  poster.addEventListener("wheel", (e) => {
    if (!selected) return;
    e.preventDefault();
    const s = parseFloat(selected.dataset.scale || "1");
    const next = Math.min(3.0, Math.max(0.2, s + (e.deltaY < 0 ? 0.06 : -0.06)));
    selected.dataset.scale = String(next);
    applyTransform(selected);
  }, { passive:false });

  // keyboard: delete + z-order
  // ] forward, [ backward, Shift+] to front, Shift+[ to back
  window.addEventListener("keydown", (e) => {
    if (!selected) return;

    if (e.key === "Delete" || e.key === "Backspace") {
      selected.remove();
      selected = null;
      return;
    }
    if (e.key === "]") { e.shiftKey ? bringToFront(selected) : bringForward(selected); return; }
    if (e.key === "[") { e.shiftKey ? sendToBack(selected)   : sendBackward(selected); return; }
  });

  /* ---------- Floating label PNGs (smaller & closer to your mockup) ---------- */
  // Put these files next to this HTML:
  // sticker_title.png, sticker_loot_arrow.png, sticker_date.png, sticker_footer.png
  addStickerPNG({ src:"sticker_title.png",      x:35, y:13, w:340, rot:-0, floatVariant:1 });
  addStickerPNG({ src:"sticker_loot_arrow.png", x:74, y:50, w:220, rot:0,   floatVariant:2 });
  addStickerPNG({ src:"sticker_date.png",       x:18, y:95, w:150, rot:0,   floatVariant:3 });
  addStickerPNG({ src:"sticker_footer.png",     x:80, y:93, w:200, rot:0,   floatVariant:4 });

  /* ---------- Spawn draggable objects (edit to your real PNG names) ---------- */
  // Place your realistic PNGs next to this HTML and name them exactly like below
  // OR change the src names:
  const objects = [
    { src:"rock_big.png", x:45, y:72, w:240, rot:-10, scale:1.0, z:20 },
    { src:"lamp.png",     x:52, y:67, w:160, rot:0,   scale:1.0, z:21 },
    { src:"branch.png",   x:62, y:74, w:340, rot:-12, scale:1.0, z:22 }
  ];
  objects.forEach(makeObject);
</script>
</body>
</html>
